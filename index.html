---
layout: default
---

<script charset='utf-8' src='//d3js.org/d3.v4.min.js'></script>
<script charset='utf-8' src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
<script src=
'https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.1/mapbox-gl-geocoder.min.js'>
</script>
<script src="js/new_lookup_tool.js"></script>

<form>
    <input id="mi_distrito_placeholder_2" onchange="getCandidates()" type="hidden">
    <input id="mi_municipio_placeholder_2" onchange="getCandidates()" type="hidden">
</form>

<div class="row" style="width: 100%; margin:0 auto;">
    <div style="font-size: 26px; width: 100%; margin:0 auto">
        <h2><p class='text-center' style="color:#3F626B; background: #fbe3e0; padding: 6px">Ingresa tu dirección o haz clic en el mapa para conocer a las y los candidatos por los que te tocará votar.<br></p></h2>
    </div>
    <div class='filter_level' style='width: 86%; margin:0 auto;'>
        <br>
        <p class='text-center' style="font-size: 20px"><b>Mostrar candidatos a:</b><br>
        <label><input checked="checked" id="show_alcalde_results" onchange="showResults()" type="checkbox" value="alcalde">
        Alcalde</label> 
        <label><input checked="checked" id="show_dl_results" onchange="showResults()"
        type="checkbox" value="dl"> Diputado Local</label> 
        <label><input checked="checked" id=
        "show_df_results" onchange="showResults()" type="checkbox" value="df"> Diputado Federal</label>
        <label><input checked="checked" id="show_senador_results" onchange="showResults()" type=
        "checkbox" value="senador"> Senador</label> 
        <label><input checked="checked" id=
        "show_gobernador_results" onchange="showResults()" type="checkbox" value="gobernador">
        Gobernador</label> 
        <label><input checked="checked" id="show_presidente_results" onchange=
        "showResults()" type="checkbox" value="presidente"> Presidente</label></p>
    </div>
</div>
<div id='map' style='width: 86%; height: 450px; margin:0 auto;'></div>
<div class="row" style='width: 82%; margin:0 auto;'>
    <div class='col-md-10 col-md-offset-1'>
        <div class='text-center' id='no-response-container' style="display:none;">
            <h2><i class='fa fa-exclamation-triangle' style="color:#EA4233"></i></h2>
            <h2 style="color:#EA4233">No se encontraron candidatos.</h2>
            <p>No pudimos encontrar ningún candidato para esa dirección. Verifica que la dirección
            ingresada esté dentro de Jalisco, México e intenta de nuevo.</p>
        </div>
        <div id='response-container' style="display:none;">
            <div style="color:#3F626B; font-size: 18px">
                <br>
                <p class='text-center'><b>Esta ubicación pertenece al Distrito Federal y Local de Jalisco
                número <span id="mi_distrito_placeholder"></span> y el municipio de 
                <span id="mi_municipio_placeholder">__</span>.<br>
                <br></b></p>
            </div>
            <p class="lead text-center" id='results-nav' style="color:#3d626b; font-size: 19px">
            <b>Candidaturas</b><br>
            <span id='alcalde-nav' style="display:none;"><a href="#alcalde-name" id=
            "alcalde-name-nav">Presidente Municipal</a> &nbsp;&nbsp;&nbsp;&nbsp;|</span> <span id=
            'dl-nav'><a href="#dl-name" id="dl-name-nav">Diputado Local</a>
            &nbsp;&nbsp;&nbsp;&nbsp;|</span> <span id='df-nav'><a href="#df-name" id="df-name-nav">Diputado
            Federal</a> &nbsp;&nbsp;&nbsp;&nbsp;|</span> <span id='senador-nav'><a href="#senador-name" id=
            "senador-name-nav">Senadores de la República por Jalisco</a> &nbsp;&nbsp;&nbsp;&nbsp;|</span>
            <span id='gobernador-nav'><a href="#gobernador-name" id="gobernador-name-nav">Gobernador de
            Jalisco</a> &nbsp;&nbsp;&nbsp;&nbsp;|</span> <span id='presidente-nav'><a href=
            "#presidente-name" id="presidente-name-nav">Presidente de la República</a></span></p>
            <div class='text-center' id='alcalde-container-not-found' style='display: none;'>
                <h3 class='text-center' id="alcalde-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>
            <div id='alcalde-container'>
                <br>
                <h3 class='text-center' id="alcalde-name">Presidente Municipal</h3>
                <table class="table table-striped table-responsive" id="alcalde-results">
                    <thead>
                        <tr>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'>
                    <a href="/informacion.html#alcalde">Conoce las funciones de un presidente municipal.</a>
                </div>
            </div>
            <div class='text-center' id='dl-container-not-found' style='display: none;'>
                <h3 class='text-center' id="dl-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>
            <div id='dl-container'>
                <br>
                <h3 class='text-center' id="dl-name">Diputado Local</h3>
                <table class="table table-striped table-responsive" id="dl-results">
                    <thead>
                        <tr>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'>
                    <a href="/informacion.html#diputado-local">Conoce las funciones de un diputado local.</a>
                </div>
            </div>
            <div class='text-center' id='df-container-not-found' style='display: none;'>
                <h3 class='text-center' id="df-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>
            <div id='df-container'>
                <br>
                <h3 class='text-center' id="df-name">Diputado Federal</h3>
                <table class="table table-striped table-responsive" id="df-results">
                    <thead>
                        <tr>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'>
                    <a href="/informacion.html#diputado-federal">Conoce las funciones de un diputado federal.</a>
                </div>
            </div>
            <div class='text-center' id='senador-container-not-found' style='display: none;'>
                <h3 class='text-center' id="senador-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>
            <div id='senador-container'>
                <br>
                <h3 class='text-center' id="senador-name">Senadores de la República por Jalisco</h3>
                <table class="table table-striped table-responsive" id="senador-results">
                    <thead>
                        <tr>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'>
                    <a href="/informacion.html#senador">Conoce las funciones de un senador.</a>
                </div>
            </div>
            <div class='text-center' id='gobernador-container-not-found' style='display: none;'>
                <h3 class='text-center' id="gobernador-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>
            <div id='gobernador-container'>
                <br>
                <h3 class='text-center' id="gobernador-name">Gobernador de Jalisco</h3>
                <table class="table table-striped table-responsive" id="gobernador-results">
                    <thead>
                        <tr>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'>
                    <a href="/informacion.html#gobernador">Conoce las funciones del gobernador de Jalisco.</a>
                </div>
            </div><br>
            <div id='presidente-container'>
                <h3 class='text-center' id='presidente-name'>Presidente de la República</h3>
                <table class="table table-striped table-responsive" id="presidente-results">
                    <thead>
                        <tr>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'>
                    <a href="/informacion.html#presidente">Conoce las funciones del presidente de la república.</a>
                </div>
            </div>
        </div>
    </div>
</div>
<div>
    <p><br></p>
</div>
<hr>
<div class='row'>
    <div class='col-md-5 col-md-offset-2'>
        <br>
        <h2>Acerca de</h2>
        <div class='about'>
            <p><span style="font-family:'Fira Sans', 'Lato', 'Open Sans', 'Arial', sans-serif; font-weight: bold; font-style: italic;">Jalisco Cómo Votamos</span> es un proyecto de código abierto del observatorio ciudadano <a href="http://jaliscocomovamos.org">Jalisco Cómo Vamos</a>. Es una herramienta que las y los ciudadanos de Jalisco pueden usar para conocer a las y los candidatos que encontrarán en su boleta el próximo día de elecciones, basado en la dirección de su credencial para votar.</p>  <p><span style="font-family:'Fira Sans', 'Lato', 'Open Sans', 'Arial', sans-serif; font-weight: bold; font-style: italic;">Jalisco Cómo Votamos</span> es una de las dos plataformas que Jalisco Cómo Vamos está manejando este proceso electoral y que pone al servicio de la comunidad. La segunda plataforma, <a href="http://jaliscocomovamos.org/ofertodromo">El Ofertódromo</a>, recopila las ofertas y promesas de campaña de las y los candidatos para consulta ciudadana.</p>
            <p style="font-size: 18px"><a href="/informacion.html">Más información
            sobre este proyecto y el proceso electoral &raquo;</a></p><br> 
            
        </div>
    </div><br>
    <div class='col-md-3 hidden-xs hidden-sm'><img alt='Jalisco' class='img-responsive' src=
    'images/jalisco.png' style='height: 300px;' title='Jalisco'></div>
</div><br>
<hr>
<br>
<br>


<script type="text/javascript">

// Reload to top of page
$(window).on('beforeunload', function(){
    $(window).scrollTop(0);
});

// List municipios
var all_municipios = [];
$.getJSON("lista_municipios.json", function(data) {
        for (i = 0; i < data.length; i++) {
            all_municipios.push(data[i].Name)
        };
    });

$(function() {
      results_level = ['alclade', 'dl', 'df', 'senador', 'gobernador', 'presidente'];
      
      // set levels of government checkboxes
      if (results_level.indexOf("alcalde") >= 0)
        $('#show_alcalde_results').prop('checked', true);
      if (results_level.indexOf("dl")  >= 0)
        $('#show_dl_results').prop('checked', true);
      if (results_level.indexOf("df")  >= 0)
        $('#show_df_results').prop('checked', true);
      if (results_level.indexOf("senador")  >= 0)
        $('#show_senador_results').prop('checked', true);
      if (results_level.indexOf("gobernador")  >= 0)
        $('#show_gobernador_results').prop('checked', true);
      if (results_level.indexOf("presidente")  >= 0)
        $('#show_presidente_results').prop('checked', true);

      $("#results-nav a").click(function(e) {
        e.preventDefault();
        var scroll_to = $($("#" + e.target.id).attr('href'));
        $('html, body').animate({
            scrollTop: scroll_to.offset().top
        }, 1000);
      });
});

mapboxgl.accessToken = 'pk.eyJ1IjoiZm9zc3ZpY2siLCJhIjoiY2l1dHpvZjMyMDF5NTJ5b2U4dml3OXl4NSJ9.nfzJubKqRYD5mfehv_qMxg';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/fossvick/cjfrrbe7k6dkf2rqxi4ctqcnr',
    center: [-103.346497, 20.676242], // starting position
    zoom: 7,
});
map.getCanvas().style.cursor = 'pointer';

var colors = ["#911eb4", "#46f0f0", "#f032e6", "#d2f53c", "#fabebe",
"#008080", "#e6beff", "#aa6e28", "#000080", "#800000",
"#aaffc3", "#808000", "#ffd8b1", "#3cb44b", "#808080",
"#e6194b", "#fffac8", "#ffe119", "#0082c8", "#f58231",];


// create an empty array to keep track of popups
var popups = [];

map.on('load', function() {
    d3.json('archivos_mapa/municipios_y_distritos_jalisco.geojson', function(data) {
        let geocoder2 = new MapboxGeocoder({
            accessToken: mapboxgl.accessToken,
            country: 'mx',
            language: 'es',
            placeholder: 'Buscar'
        });
        map.addControl(geocoder2);
        map.addControl(new mapboxgl.NavigationControl());
        geocoder2.on('result', function(res) {
            $('#no-response-container').hide();
            $("#response-container").show();
            if (popups.length > 0) {
                //remove all the popups from the map if they already exist
                popups.forEach(function(popup) {
                    popup.remove();
                });
            }
            // put lat / lon into a turf point (just for a shorter variable name)
            let pt = turf.point(res.result.geometry.coordinates);
            // iterate through multipolygons to see which one point is inside
            data.features.forEach(function(feature) {
                // turf.inside is a method to check whether a point is inside a polygon
                if (turf.inside(pt, feature)) {
                    if (/\d/.test(feature.properties.Name.slice())) { 
                        mi_distrito = feature.properties.Name.slice().replace(/\D/g, '')
                    } else {
                        mi_municipio = feature.properties.Name.slice()
                    }
                }
            });
            searchedPopup = new mapboxgl.Popup().setLngLat(pt.geometry.coordinates).setHTML("<br>" +
                    mi_municipio + "<br>Distrito " + mi_distrito).addTo(map);
            popups.push(searchedPopup);
            document.getElementById("mi_distrito_placeholder").innerHTML = mi_distrito;
            document.getElementById("mi_distrito_placeholder_2").innerHTML = mi_distrito;
            document.getElementById("mi_municipio_placeholder").innerHTML = mi_municipio;
            document.getElementById("mi_municipio_placeholder_2").innerHTML = mi_municipio;
            getCandidates();
            map.flyTo({
                center: pt.geometry.coordinates,
                zoom: 13.5,
                speed: 10
            });      
        });
        map.addSource('jalisco', {
            type: 'geojson',
            data: data
        });
        map.addLayer({
            'id': 'jalisco',
            'type': 'fill',
            'source': 'jalisco',
            'paint': {
                'fill-opacity': 0
            }
        });
    });
    d3.json('archivos_mapa/distritos_jalisco.geojson', function(data2) {
        data2.features.forEach((distrito, index) => {
            map.addSource(distrito.properties.Name, {
                type: 'geojson',
                data: distrito
            });
            // just add this layer for the colors
            map.addLayer({
                'id': distrito.properties.Name,
                'type': 'fill',
                'source': distrito.properties.Name,
                'paint': {
                    'fill-color': colors[index],
                    'fill-opacity': 0.35
                }
            });
        })
    })
})

map.on('click', 'jalisco', function (e) {
    clickedPopup = new mapboxgl.Popup()
        .setLngLat(e.lngLat)
        .setHTML("<br>" + e.features.map(function(feature) { return feature.properties.Name; }).join('<br>'))
        .addTo(map);
    popups.push(clickedPopup);
    mi_distrito = e.features.map(function(feature) { return feature.properties.Name; })[1].slice().replace(/\D/g, '');
    mi_municipio = e.features.map(function(feature) { return feature.properties.Name; })[0].slice();
    document.getElementById("mi_distrito_placeholder").innerHTML = mi_distrito;
    document.getElementById("mi_distrito_placeholder_2").innerHTML = mi_distrito;
    document.getElementById("mi_municipio_placeholder").innerHTML = mi_municipio;
    document.getElementById("mi_municipio_placeholder_2").innerHTML = mi_municipio;
    $('#no-response-container').hide();
    $("#response-container").show();
    getCandidates();
});


</script>
