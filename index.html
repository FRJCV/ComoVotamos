---
layout: default
---

<script src='//d3js.org/d3.v4.min.js' charset='utf-8'></script>
<script src='https://npmcdn.com/@turf/turf/turf.min.js' charset='utf-8'></script>
<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.1/mapbox-gl-geocoder.min.js'></script>
<script src="js/new_lookup_tool.js"></script>

<input id="mi_distrito_placeholder_2" type="hidden" onchange="getCandidates()">

<div class="container-fluid text-center">
    <p class='lead'>Conoce a tus candidatos en las Elecciones de 2018 en el estado de Jalisco, México.</p>
</div>
    
 <div class="row">


<div style="color:#3E66B0; font-size: 26px"><br /><p class='text-center'><b>
    Ingresa tu dirección o haz clic en el mapa para ver a qué distrito federal y local perteneces. 
<br/></b></p></div>

<div class='text-center' style='width: 86%; margin:0 auto;'><h1><i class='fa fa-exclamation-triangle text-center' style="color:#EA4233"></i> </h1>
            <h2 style="color:#EA4233; font-size:22px" >Para el aprovechamiento óptimo de la plataforma estamos ajustado los últimos detalles, por favor siga pendiente de Jalisco Cómo Votamos.</h2></div>

        <div class='filter_level' style='width: 86%; margin:0 auto;'>
            <br /><p class='text-center'>
                <b>Mostrar candidatos a:</b><br />
                <label>
                    <input type="checkbox" id="show_alcalde_results" value="alcalde" value="0" onchange="showResults()"> Alcalde
                </label>
                <label>
                    <input type="checkbox" id="show_dl_results" value="dl" checked="checked" onchange="showResults()"> Diputado Local
                </label>
                <label>
                    <input type="checkbox" id="show_df_results" value="df" checked="checked" onchange="showResults()"> Diputado Federal
                </label>
                <label>
                    <input type="checkbox" id="show_senador_results" value="senador" checked="checked" onchange="showResults()"> Senador
                </label>
                <label>
                    <input type="checkbox" id="show_gobernador_results" value="gobernador" checked="checked" onchange="showResults()"> Gobernador
                </label>
                <label>
                    <input type="checkbox" id="show_presidente_results" value="presidente" checked="checked" onchange="showResults()"> Presidente
                </label>
            </p>
        </div>
    </div>




<div id='map' style='width: 86%; height: 450px; margin:0 auto;' ></div>


<div class="row">
    <div class='col-md-10 col-md-offset-1'>

        <div id='no-response-container' class='text-center' style="display:none;">
            <h2><i class='fa fa-exclamation-triangle' style="color:#EA4233"></i> </h2>
            <h2 style="color:#EA4233">No se encontraron candidatos.</h2>
            <p>No pudimos encontrar ningún candidato para esa dirección. Verifica que la dirección ingresada esté dentro de Jalisco, México e intenta de nuevo.</p>
        </div>

        <div id='response-container' style="display:none;">

            <div style="color:#3E66B0; font-size: 18px"><br /><p class='text-center'><b>
            Esta ubicación pertenece al Distrito Federal y Local de Jalisco número <span id="mi_distrito_placeholder"></span>.
            <br/><br/></b></p></div>

            <p class="lead text-center" id='results-nav' style="color:#3d626b; font-size: 19px">
                <b>Candidaturas</b><br />
                  <span id='alcalde-nav' style="display:none;">
                    <a id="alcalde-name-nav" href="#local-name">Presidente Municipal</a>
                  &nbsp;&nbsp;&nbsp;&nbsp;|</a>
                  </span>
                  <span id='dl-nav'>
                    <a id="dl-name-nav" href="#dl-name">Diputado Local</a>
                  &nbsp;&nbsp;&nbsp;&nbsp;|</a>
                  </span>
                  <span id='df-nav'>
                    <a id="df-name-nav" href="#df-name">Diputado Federal</a>
                  &nbsp;&nbsp;&nbsp;&nbsp;|</a>
                  </span>
                  <span id='senador-nav'>
                    <a id="senador-name-nav" href="#senador-name">
                        Senadores de la República por Jalisco</a>
                  &nbsp;&nbsp;&nbsp;&nbsp;|</span>
                    </a>
                  </span>
                  <span id='gobernador-nav'>
                    <a id="gobernador-name-nav" href="#gobernador-name">Gobernador de Jalisco</a>
                  &nbsp;&nbsp;&nbsp;&nbsp;|</span>
                  <span id='presidente-nav'>
                    <a id="presidente-name-nav" href="#presidente-name">Presidente de la República</a>
                  </span>
            </p>


            <div id='alcalde-container-not-found' style='display: none;' class='text-center'>
                <h3 class='text-center' id="alcalde-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>

            <div id='alcalde-container' style="display:none;">
                <br />
                <h3 class='text-center' id="alcalde-name">Presidente Municipal</h3>
                <table id="alcalde-results" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'><a href="/informacion.html#alcalde">
                Conoce las funciones de un presidente municipal.</a></div>
            </div>

            <div id='dl-container-not-found' style='display: none;' class='text-center'>
                <h3 class='text-center' id="dl-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>

            <div id='dl-container'>
                <br />
                <h3 class='text-center' id="dl-name">Diputado Local</h3>
                <table id="dl-results" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'><a href="/informacion.html#diputado-local">
                Conoce las funciones de un diputado local.</a></div>
            </div>


            <div id='df-container-not-found' style='display: none;' class='text-center'>
                <h3 class='text-center' id="df-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>

            <div id='df-container'>
                <br />
                <h3 class='text-center' id="df-name">Diputado Federal</h3>
                <table id="df-results" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class='text-center'><a href="/informacion.html#diputado-federal">
                Conoce las funciones de un diputado federal.</a></div>
            </div>

            <div id='senador-container-not-found' style='display: none;' class='text-center'>
                <h3 class='text-center' id="senador-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>

            <div id='senador-container'>
                <br />
                <h3 class='text-center' id="senador-name">Senadores de la República por Jalisco</h3>
                <table id="senador-results" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <div id='gobernador-container-not-found' style='display: none;' class='text-center'>
                <h3 class='text-center' id="gobernador-name-not-found"></h3>
                <p>No pudimos encontrar ningún candidato para esa dirección.</p>
            </div>

            <div id='gobernador-container'>
                <br />
                <h3 class='text-center' id="gobernador-name">Gobernador de Jalisco</h3>
                <table id="gobernador-results" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <br/>
            <div id='presidente-container'>
                <h3 id='presidente-name' class='text-center'>Presidente de la República</h3>
                <table id="presidente-results" class="table table-striped table-responsive">
                    <thead>
                        <tr>
                            <th></th>
                            <th><i class='fa fa-user'></i> Candidato</th>
                            <th><i class='fa fa-certificate'></i> Partido</th>
                            <th><i class='fa fa-external-link'></i> Enlaces</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>
<div><p><br /></p></div>

<hr />
<div class='row'>
    <div class='col-md-5 col-md-offset-2'>
        <br />
        <h2>Acerca de</h2>
        <div class='about'>
            <p>Ésta es una herramienta para ubicar a los candidatos a Alcalde, Diputado Local, Diputado Federal, Senador, Gobernador y Presidente de la República para las elecciones de 2018 en el estado de Jalisco, México, basado en tu dirección registrada en INE.
            </p>

            <p><small>Si encuentas algún error, <a href="javascript:void(0)">avísanos por favor</a> para que podamos actualizar nuestra base de datos y mejorar esta herramienta.</small></p>
            <p style="font-size: 20px"><b><a href="/informacion.html">Más información para votantes</a></b></p>
        </div>
    </div>
    <br />
    <div class='col-md-3 hidden-xs hidden-sm'>
        <img class='img-responsive' src='images/jalisco2.png' style='height: 275px;' title='Jalisco'  alt='Jalisco' />
    </div>
</div>
<br />
<hr />
<br /><br />


<script type="text/javascript">

$(function() {
      results_level = ['dl', 'df', 'senador', 'gobernador', 'presidente'];
      
      // set levels of government checkboxes
      if (results_level.indexOf("alcalde") > 0)
        $('#show_alcalde_results').prop();
      if (results_level.indexOf("dl")  >= 0)
        $('#show_dl_results').prop('checked', true);
      if (results_level.indexOf("df")  >= 0)
        $('#show_df_results').prop('checked', true);
      if (results_level.indexOf("senador")  >= 0)
        $('#show_senador_results').prop('checked', true);
      if (results_level.indexOf("gobernador")  >= 0)
        $('#show_gobernador_results').prop('checked', true);
      if (results_level.indexOf("presidente")  >= 0)
        $('#show_presidente_results').prop('checked', true);

      $("#results-nav a").click(function(e) {
        e.preventDefault();
        var scroll_to = $($("#" + e.target.id).attr('href'));
        $('html, body').animate({
            scrollTop: scroll_to.offset().top
        }, 1000);
      });
});

mapboxgl.accessToken = 'pk.eyJ1IjoiZm9zc3ZpY2siLCJhIjoiY2l1dHpvZjMyMDF5NTJ5b2U4dml3OXl4NSJ9.nfzJubKqRYD5mfehv_qMxg';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/fossvick/cjfrrbe7k6dkf2rqxi4ctqcnr',
    center: [-103.346497, 20.676242], // starting position
    zoom: 7,
});

var colors = ["#911eb4", "#46f0f0", "#f032e6", "#d2f53c", "#fabebe",
"#008080", "#e6beff", "#aa6e28", "#000080", "#800000",
"#aaffc3", "#808000", "#ffd8b1", "#3cb44b", "#808080",
"#e6194b", "#fffac8", "#ffe119", "#0082c8", "#f58231",];

// create an empty array to keep track of popups
var popups = [];

map.on('load', function() {
    d3.json('archivos_mapa/distritos_jalisco.geojson', function(data) {
        let geocoder2 = new MapboxGeocoder({
            accessToken: mapboxgl.accessToken,
            country: 'mx',
            language: 'es',
            placeholder: 'Buscar'
        });
        map.addControl(geocoder2);
        map.addControl(new mapboxgl.NavigationControl());
        data.features.forEach((distrito, index) => {
            map.addSource(distrito.properties.Name, {
                type: 'geojson',
                data: distrito
            });
            // map layer needs an id, type, the source and a style
            map.addLayer({
                'id': distrito.properties.Name,
                'type': 'fill',
                'source': distrito.properties.Name,
                'paint': {
                    'fill-color': colors[index],
                    'fill-opacity': 0.35
                }
            });
            // listen to 'result' event to see which address and coordinate is searched
            geocoder2.on('result', function(res) {
                $('#no-response-container').hide();
                $("#response-container").show();
                if (popups.length > 0) {
                    //remove all the popups from the map if they already exist
                    popups.forEach(function(popup) {
                        popup.remove();
                    });
                }
                // put lat / lon into a turf point (just for a shorter variable name)
                let pt = turf.point(res.result.geometry.coordinates);
                //iterate through multipolygons to see which one point is inside
                data.features.forEach(function(feature) {
                    // turf.inside is a method to check whether a point is inside a polygon
                    if (turf.inside(pt, feature)) {
                        let searchedPopup = new mapboxgl.Popup().setLngLat(pt.geometry.coordinates).setHTML(
                            "<br\><b>" + feature.properties.Name + "</b>").addTo(map);
                        popups.push(searchedPopup);
                        map.flyTo({
                            center: pt.geometry.coordinates,
                            zoom: 13.5,
                            speed: 10
                        });
                        mi_distrito = feature.properties.Name.slice().replace(/\D/g, '');
                        document.getElementById("mi_distrito_placeholder").innerHTML = mi_distrito;
                        document.getElementById("mi_distrito_placeholder_2").innerHTML = mi_distrito;
                        getCandidates()
                    }
                })
            })
        });
    });
});
for (i = 0; i < 21; i++) {
    (function(i) {
        map.on('click', 'Distrito ' + i, function(e) {
            mi_distrito = e.features[0].properties.Name.slice().replace(/\D/g, '');
            let clickedPopup = new mapboxgl.Popup().setLngLat(e.lngLat).setHTML("<br\><b>" + e.features[0].properties
                .Name + "</b>").addTo(map);
            popups.push(clickedPopup);
            $('#no-response-container').hide();
            $("#response-container").show();
            document.getElementById("mi_distrito_placeholder").innerHTML = mi_distrito;
            document.getElementById("mi_distrito_placeholder_2").innerHTML = mi_distrito;
            getCandidates()
        });
        map.on('mouseenter', 'Distrito ' + i, function() {
            // Change the cursor style as a UI indicator.
            map.getCanvas().style.cursor = 'pointer';
        });
        map.on('mouseleave', 'Distrito' + i, function() {
            // Change the cursor style back as a UI indicator.
            map.getCanvas().style.cursor = '';
        });
    })(i);
}

function getCandidates() {
    // <!-- Add Alcaldes -->
    $.getJSON("lista_candidatos.json", function(data) {
        $("#alcalde-results tbody tr").remove();
        var items = [];
        for (i = 0; i < data.length; i++) {
            if (data[i].Candidatura.includes("Alcalde")) items.push("<tr><td></td><td>" + data[i].Nombre +
                " (" + data[i].Candidatura.slice(8, ) + ")</td><td>" + data[i].Partido +
                "</td><td></td></tr>")
        };
        $('#alcalde-results').find('tbody').append(items)
    });
    // <!-- Add Diputados Locales -->
    var mi_distrito2 = parseInt($("#mi_distrito_placeholder_2").text().replace(/\*/gmi, ""), 10)
    $.getJSON("lista_candidatos.json", function(data) {
        $("#dl-results tbody tr").remove();
        var items = [];
        for (i = 0; i < data.length; i++) {
            if (data[i].Candidatura.includes("Diputado Local DTTO. " + mi_distrito2 + " ")) items.push(
                "<tr><td></td><td>" + data[i].Nombre + " (Distrito " + data[i].Candidatura.replace(/\D/g, '') +
                ")</td><td>" + data[i].Partido + "</td><td></td></tr>")
        };
        $('#dl-results').find('tbody').append(items)
    });
    // <!-- Add Diputados Federales -->
    $.getJSON("lista_candidatos.json", function(data) {
        $("#df-results tbody tr").remove();
        var items = [];
        for (i = 0; i < data.length; i++) {
            if (data[i].Candidatura === "Diputado Federal DTTO. " + mi_distrito2) items.push(
                "<tr><td></td><td>" + data[i].Nombre + " (Distrito " + data[i].Candidatura.replace(/\D/g, '') +
                ")</td><td>" + data[i].Partido + "</td><td></td></tr>")
        };
        $('#df-results').find('tbody').append(items)
    });
    // <!-- Add candidates for the senate -->
    $("#senador-results tbody tr").remove();
    $.getJSON("lista_candidatos.json", function(data) {
        var items = [];
        for (i = 0; i < data.length; i++) {
            if (data[i].Candidatura === "Senador") items.push("<tr><td></td><td>" + data[i].Nombre +
                "</td><td>" + data[i].Partido + "</td><td></td></tr>")
        };
        $('#senador-results').find('tbody').append(items)
    });
    // <!-- Add gubernatorial candidates -->
    $("#gobernador-results tbody tr").remove();
    $.getJSON("lista_candidatos.json", function(data) {
        var items = [];
        for (i = 0; i < data.length; i++) {
            if (data[i].Candidatura === "Gobernador") items.push("<tr><td></td><td>" + data[i].Nombre +
                "</td><td>" + data[i].Partido + "</td><td></td></tr>")
        };
        $('#gobernador-results').find('tbody').append(items)
    });
    // <!-- Add presidential candidates -->
    $("#presidente-results tbody tr").remove();
    $.getJSON("lista_candidatos.json", function(data) {
        var items = [];
        for (i = 0; i < data.length; i++) {
            if (data[i].Candidatura === "Presidente") items.push("<tr><td></td><td>" + data[i].Nombre +
                "</td><td>" + data[i].Partido + "</td><td></td></tr>")
        };
        $('#presidente-results').find('tbody').append(items)
    });
}
</script>

